---
title: "Curious Case of an Under-dev Malware"
excerpt: "Blog explaining the process of reverse engineering a random dotnet sample."
last_modified_at: 2024-06-03T09:45:06-05:00
header:
  teaser: "assets/images/markup-syntax-highlighting-teaser.jpg"
tags: 
  - RE
  - Dotnet
  - Obfuscation
toc: true
---

This post is a sequel to [Curious Case of a Dotnet Binary]({{ site.baseurl }}{% link _posts/2024-05-30-curious-dotnet-malware.md %}), where we come across a sample that seems to be missing the C2 information and sample being under development. In order to confirm this suspicioun I embarked on the journey to find the final sample with the C2 information.

### Virustotal Intelligence
Here with the help of Virustotal Intelligence I downloaded the samples that were similar to the original binary aea3598323131fec106e5e1d64655f84. I sorted these samples on basis of "First Submission" and started picked the latest sample (6cbd723c5227114ca2dbc017d530799f) in hopes it would have the C2 information.

### Stages
This sample was mostly like the original sample with a few exceptions. The first stage was missing obfuscations and did not requires any deobfuscation. All other stages until to the final stage were the same and were unpacked recreating the steps from analysis of aea3598323131fec106e5e1d64655f84 (from first blog).

### Final Payload
Here the final payload was not a C++ sample but rather another .NET binary:

<figure>
  <img src="{{ '/assets/images/blog2.png' | relative_url }}" alt="Finding this sample on MalwareBazaar">
</figure>

Here we can see following functionality in action just like the original sample:
- Keylogger
- Screenlogger

Let's look for the C2 information in this sample. Here we see a section of code preparing HTTP Web Request:

<figure>
  <img src="{{ '/assets/images/blog2_1.png' | relative_url }}" alt="Finding this sample on MalwareBazaar">
</figure>

Let's see what the requestURIString being passed here:

<figure>
  <img src="{{ '/assets/images/blog2_2.png' | relative_url }}" alt="Finding this sample on MalwareBazaar">
</figure>

The IpApi variable is supposed to have C2 IP/URL and it is empty as it was in the original sample. 

### Conclusion
We have some under development samples at hand that are uploaded to the web with the C2 information redacted.